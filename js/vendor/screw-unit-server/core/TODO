need a way to do global before and afters
need to investigate race condition with data store